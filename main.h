#pragma once

#include <stdint.h>

static const uint16_t masks[] = {
  0x0000, 0x0001, 0x0003, 0x0007, 0x000F, 0x001F, 0x003F, 0x007F, 0x00FF,
  0x01FF, 0x03FF, 0x07FF, 0x0FFF, 0x1FFF, 0x3FFF, 0x7FFF, 0xFFFF,
};

typedef struct item_data_t {
  uint16_t w0;
  uint16_t w2;
} item_data_t;

typedef struct item_t {
  uint16_t index;
  item_data_t items[9];
} item_t;

static const item_t table[] = {
  {0x0000, { {0x0001, 0x0001}, {0x0001, 0x0000}, {0x0000, 0x0000}, {0x0000, 0x0000}, {0x0000, 0x0000}, {0x0000, 0x0000}, {0x0000, 0x0000}, {0x0000, 0x0000}, {0x0000, 0x0000} }},
  {0x0001, { {0x0005, 0x0002}, {0x0002, 0x0001}, {0x0001, 0x0000}, {0x0000, 0x0000}, {0x0000, 0x0000}, {0x0000, 0x0000}, {0x0000, 0x0000}, {0x0000, 0x0000}, {0x0000, 0x0000} }},
  {0x0001, { {0x0009, 0x0003}, {0x0002, 0x0001}, {0x0001, 0x0000}, {0x0000, 0x0000}, {0x0000, 0x0000}, {0x0000, 0x0000}, {0x0000, 0x0000}, {0x0000, 0x0000}, {0x0000, 0x0000} }},
  {0x0002, { {0x001D, 0x0004}, {0x000E, 0x0003}, {0x0006, 0x0002}, {0x0002, 0x0001}, {0x0001, 0x0000}, {0x0000, 0x0000}, {0x0000, 0x0000}, {0x0000, 0x0000}, {0x0000, 0x0000} }},
  {0x0002, { {0x002D, 0x0005}, {0x000E, 0x0003}, {0x0006, 0x0002}, {0x0002, 0x0001}, {0x0001, 0x0000}, {0x0000, 0x0000}, {0x0000, 0x0000}, {0x0000, 0x0000}, {0x0000, 0x0000} }},
  {0x0002, { {0x0059, 0x0006}, {0x001A, 0x0004}, {0x000A, 0x0003}, {0x0002, 0x0001}, {0x0001, 0x0000}, {0x0000, 0x0000}, {0x0000, 0x0000}, {0x0000, 0x0000}, {0x0000, 0x0000} }},
  {0x0002, { {0x00A9, 0x0007}, {0x002A, 0x0005}, {0x000A, 0x0003}, {0x0002, 0x0001}, {0x0001, 0x0000}, {0x0000, 0x0000}, {0x0000, 0x0000}, {0x0000, 0x0000}, {0x0000, 0x0000} }},
  {0x0003, { {0x01FD, 0x0008}, {0x00FE, 0x0007}, {0x007E, 0x0006}, {0x003E, 0x0005}, {0x001E, 0x0004}, {0x000E, 0x0003}, {0x0006, 0x0002}, {0x0002, 0x0001}, {0x0001, 0x0000} }},
  {0x0003, { {0x02FD, 0x0009}, {0x00FE, 0x0007}, {0x007E, 0x0006}, {0x003E, 0x0005}, {0x001E, 0x0004}, {0x000E, 0x0003}, {0x0006, 0x0002}, {0x0002, 0x0001}, {0x0001, 0x0000} }},
  {0x0003, { {0x05ED, 0x000A}, {0x01EE, 0x0008}, {0x00EE, 0x0007}, {0x006E, 0x0006}, {0x002E, 0x0005}, {0x000E, 0x0003}, {0x0006, 0x0002}, {0x0002, 0x0001}, {0x0001, 0x0000} }},
  {0x0003, { {0x0B75, 0x000B}, {0x0376, 0x0009}, {0x0176, 0x0008}, {0x0076, 0x0006}, {0x0036, 0x0005}, {0x0016, 0x0004}, {0x0006, 0x0002}, {0x0002, 0x0001}, {0x0001, 0x0000} }},
  {0x0003, { {0x16D9, 0x000C}, {0x06DA, 0x000A}, {0x02DA, 0x0009}, {0x00DA, 0x0007}, {0x005A, 0x0006}, {0x001A, 0x0004}, {0x000A, 0x0003}, {0x0002, 0x0001}, {0x0001, 0x0000} }},
  {0x0003, { {0x2B59, 0x000D}, {0x0B5A, 0x000B}, {0x035A, 0x0009}, {0x015A, 0x0008}, {0x005A, 0x0006}, {0x001A, 0x0004}, {0x000A, 0x0003}, {0x0002, 0x0001}, {0x0001, 0x0000} }},
  {0x0003, { {0x55A9, 0x000E}, {0x15AA, 0x000C}, {0x05AA, 0x000A}, {0x01AA, 0x0008}, {0x00AA, 0x0007}, {0x002A, 0x0005}, {0x000A, 0x0003}, {0x0002, 0x0001}, {0x0001, 0x0000} }},
  {0x0003, { {0xAAA9, 0x000F}, {0x2AAA, 0x000D}, {0x0AAA, 0x000B}, {0x02AA, 0x0009}, {0x00AA, 0x0007}, {0x002A, 0x0005}, {0x000A, 0x0003}, {0x0002, 0x0001}, {0x0001, 0x0000} }}
};


uint32_t max_compressed_size(uint32_t src_size);
int compress(const uint8_t* src, uint32_t src_size, uint8_t* dst);

int decompress(const uint8_t* src, uint8_t* dst, uint32_t* src_size);
int get_decompressed_size(const uint8_t* src);
